# -*- coding: utf-8 -*-
########################################################################################################################

import math

########################################################################################################################

# noinspection PyPep8Naming, PyRedundantParentheses
class Camera(object):

    ####################################################################################################################

    def __init__(self, a, r, θ, ϕ, br, bθ, bϕ):

        ################################################################################################################

        self._a, self._Δ, self._ρ, self._Σ, self._α, self._ϖ, self._ω = Camera.get_kerr_parameters(a, r, θ)

        ################################################################################################################

        self._r = r
        self._θ = θ
        self._ϕ = ϕ

        self._br = br
        self._bθ = bθ
        self._bϕ = bϕ

        ################################################################################################################

        # Keplerian angular velocity

        Ω = 1.0 / (a + math.pow(r, 1.5))

        self._speed = (self._ϖ / self._α) * (Ω - self._ω)

    ####################################################################################################################
    # KERR PARAMETERS                                                                                                  #
    ####################################################################################################################

    @property
    def a(self):

        return self._a

    ####################################################################################################################

    @property
    def Δ(self):

        return self._Δ

    ####################################################################################################################

    @property
    def ρ(self):

        return self._ρ

    ####################################################################################################################

    @property
    def Σ(self):

        return self._Σ

    ####################################################################################################################

    @property
    def α(self):

        return self._α

    ####################################################################################################################

    @property
    def ϖ(self):

        return self._ϖ

    ####################################################################################################################

    @property
    def ω(self):

        return self._ω

    ####################################################################################################################
    # CAMERA PARAMETERS                                                                                                #
    ####################################################################################################################

    @property
    def r(self):

        return self._r

    ####################################################################################################################

    @property
    def θ(self):

        return self._θ

    ####################################################################################################################

    @property
    def ϕ(self):

        return self._ϕ

    ####################################################################################################################

    @property
    def br(self):

        return self._br

    ####################################################################################################################

    @property
    def bθ(self):

        return self._bθ

    ####################################################################################################################

    @property
    def bϕ(self):

        return self._bϕ

    ####################################################################################################################

    @property
    def speed(self):

        return self._speed

    ####################################################################################################################
    # UTILITY                                                                                                          #
    ####################################################################################################################

    @staticmethod
    def get_kerr_parameters(a, r, θ):

        ################################################################################################################

        a2 = a * a
        r2 = r * r

        ################################################################################################################

        sinθ = math.sin(θ)
        cosθ = math.cos(θ)

        sin2θ = sinθ * sinθ
        cos2θ = cosθ * cosθ

        ################################################################################################################

        Δ = r2 - 2.0 * r + a2

        ρ2 = r2 + a2 * cos2θ

        Σ2 = (r2 + a2) ** 2 - a2 * Δ * sin2θ

        α2 = ((Δ)) * (ρ2 / Σ2)

        ϖ2 = sin2θ * (ρ2 / Σ2)

        ω = 2.0 * a * r / Σ2

        ################################################################################################################

        return a, Δ, math.sqrt(ρ2), math.sqrt(Σ2), math.sqrt(α2), math.sqrt(ϖ2), ω

    ####################################################################################################################

    def __str__(self):

        return f'a: {self._a}, Δ: {self._Δ}, ρ: {self._ρ}, Σ: {self._Σ}, α: {self._α}, ϖ: {self._ϖ}, ω: {self._ω}\nspeed: {self._speed}'

########################################################################################################################
